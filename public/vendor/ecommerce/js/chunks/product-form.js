webpackJsonp([40],{LXjS:function(t,o,e){(t.exports=e("FZ+f")(!1)).push([t.i,"",""])},TFx0:function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r,a=Object.assign||function(t){for(var o=1;o<arguments.length;o++){var e=arguments[o];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},i=e("GzQy"),s=(r=i)&&r.__esModule?r:{default:r},n=e("NYxO");var l=e("P/uL"),c=e("8r4o"),u={sections:{data:[{fields:{data:[]}}]}},d={product:{quantity:1,order_form:u,options:{},variants:{data:[],order_form:u}}};o.default={name:"ProductForm",components:{Errors:function(){return e.e(28).then(e.bind(null,"DqGP"))}},props:{editForm:{type:Boolean,required:!1,default:function(){return!1}},product:{type:Object,required:!1,default:function(){return{}}},onProductAdd:{type:Function,required:!1,default:function(){return function(t){}}}},data:function(){return{loading:!0,showModal:!1,errors:{},form:d,productCategory:"",productFirst:"",collectionToShow:{types:{data:[]}}}},computed:a({},(0,n.mapGetters)(["shopData"]),{quantityRange:function(){return c(1,251)},productsToShow:function(){return this.productCategory?this.productCategory.products.data:[]},productVariantsToShow:function(){return this.productFirst?this.productFirst.variants.data:[]},orderForm:function(){return this.objectHas(this.form,"product.order_form.sections.data")?this.form.product.order_form.sections.data:[]}}),watch:{"form.product":function(t){this.$set(this.form.product,"options",{})},productCategory:function(){this.productFirst=""},productFirst:function(t){this.objectHas(t,"variants.data")?t.variants.data.length>=1?this.form.product={}:this.form.product=t:this.form.product={}}},mounted:function(){this.editForm?(this.loading=!1,this.form.product=this.product):this.getProductCollection()},methods:{getProductCollection:function(){if(this.shopData.collection_mappings_values){var t=this.shopData.collection_mappings_values["Product Categories Collection"];this.loading=!0,s.default.get({path:"collections/"+t,params:{include:["type","options","price","effects_price","no_shop_data"],with:["types.products.variants.orderForm.sections.fields","types.products.variants.variant"]}}).then(function(t){this.collectionToShow=t.data,this.loading=!1}.bind(this)).catch(function(t){this.loading=!1,this.errors=t}.bind(this))}},closeAndClearModal:function(){var t=this;this.$confirm("Are you sure to close the product selector?").then(function(o){t.clearAll(),t.showModal=!1}).catch(function(t){})},optionLabel:function(t){return t?t.price_mutator&&t.price_value?t.name+" ("+t.price_mutator+" Â£"+t.price_value+")":t.name:""},formattedPrice:function(t){var o=parseFloat(t.price),e=o,r=0;t.options&&l(t.options,function(t){t&&t.price_mutator&&t.price_value&&(e=this.operators[t.price_mutator](e,t.price_value),r=this.operators[t.price_mutator](r,t.price_value))}.bind(this));var a=t.quantity?t.quantity:1;return{"Base Price":o,"Sub-Total":o*a,Extras:r*=a,Total:e*a}},clearAll:function(){this.errors={},this.form=d,this.productCategory="",this.productFirst=""},addProduct:function(){this.objectHas(this.form,"product.id")&&this.objectHas(this.form,"product.quantity")&&(this.showModal=!1,this.onProductAdd(this.form.product),this.clearAll())},saveProduct:function(){this.showModal=!1}}}},"ZKm+":function(t,o,e){var r=e("LXjS");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);e("rjj0")("d909c9da",r,!0,{})},jPnQ:function(t,o){t.exports={render:function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticStyle:{display:"initial"}},[e("el-button",{attrs:{loading:t.loading,size:t.editForm?"mini":"small",plain:t.editForm,type:"primary"},on:{click:function(o){t.showModal=!0}}},[t._v(t._s(t.editForm?"Edit":t.loading?"Loading Products":"Add Product(s)")+"\n  ")]),t._v(" "),e("el-dialog",{attrs:{title:(t.editForm?"Edit":"Add")+" Product","close-on-click-modal":!1,"before-close":t.closeAndClearModal,visible:t.showModal,width:"70%"},on:{"update:visible":function(o){t.showModal=o}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[e("el-form",{ref:"addProductForm",attrs:{"label-position":"top",model:t.form},nativeOn:{submit:function(t){t.preventDefault()}}},[t.editForm?t._e():e("div",{staticClass:"form_option_section"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{md:12}},[e("h5",[t._v("Product Type")])])],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{md:{span:16,offset:4}}},[e("el-form-item",{attrs:{label:"Choose Category",size:"small",prop:"productCategory"}},[e("div",[e("el-radio-group",{attrs:{size:"small"},model:{value:t.productCategory,callback:function(o){t.productCategory=o},expression:"productCategory"}},t._l(t.collectionToShow.types.data,function(o){return e("el-radio-button",{key:o.id,attrs:{label:o}},[t._v(t._s(o.name))])}))],1)])],1)],1),t._v(" "),e("el-row",{directives:[{name:"show",rawName:"v-show",value:t.productCategory,expression:"productCategory"}],attrs:{gutter:20}},[e("el-col",{attrs:{md:{span:16,offset:4}}},[e("el-form-item",{attrs:{label:"Choose Product",size:"small",prop:"productFirst"}},[e("div",[e("el-radio-group",{attrs:{size:"small"},model:{value:t.productFirst,callback:function(o){t.productFirst=o},expression:"productFirst"}},t._l(t.productsToShow,function(o){return e("el-radio-button",{key:o.id,attrs:{label:o}},[t._v(t._s(o.name))])}))],1)])],1)],1),t._v(" "),e("el-row",{directives:[{name:"show",rawName:"v-show",value:t.productFirst&&t.productVariantsToShow.length>=1,expression:"productFirst && productVariantsToShow.length >= 1"}],attrs:{gutter:20}},[e("el-col",{attrs:{md:{span:16,offset:4}}},[e("el-form-item",{attrs:{label:"Choose Variant",size:"small",prop:"product"}},[e("div",[t.productVariantsToShow.length<10?e("el-radio-group",{attrs:{size:"small"},model:{value:t.form.product,callback:function(o){t.$set(t.form,"product",o)},expression:"form.product"}},t._l(t.productVariantsToShow,function(o){return e("el-radio-button",{key:o.id,attrs:{label:o}},[t._v(t._s(o.name))])})):e("el-select",{attrs:{size:"small","value-key":"id"},model:{value:t.form.product,callback:function(o){t.$set(t.form,"product",o)},expression:"form.product"}},t._l(t.productVariantsToShow,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t}})}))],1)])],1)],1)],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.objectHas(t.form,"product.id"),expression:"objectHas(form, 'product.id')"}]},[t._l(t.orderForm,function(o){return[e("el-row",{directives:[{name:"show",rawName:"v-show",value:o.fields.data.length>0,expression:"section.fields.data.length > 0"}],attrs:{gutter:20}},[e("el-col",{attrs:{md:12}},[e("h5",[t._v(t._s(o.name))])])],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:o.fields.data.length>0,expression:"section.fields.data.length > 0"}],staticClass:"form_option_section"},t._l(o.fields.data,function(o){return e("el-row",{key:o.id,attrs:{gutter:20}},[e("el-col",{attrs:{md:{span:16,offset:4}}},[e("el-form-item",{attrs:{label:o.name,size:"small",prop:"product.options["+o.name+"]"}},["text"===o.type?e("el-input",{model:{value:t.form.product.options[o.name],callback:function(e){t.$set(t.form.product.options,o.name,e)},expression:"form.product.options[field.name]"}}):t._e(),t._v(" "),"number"===o.type?e("el-input-number",{model:{value:t.form.product.options[o.name],callback:function(e){t.$set(t.form.product.options,o.name,e)},expression:"form.product.options[field.name]"}}):t._e(),t._v(" "),"select"===o.type?e("el-select",{model:{value:t.form.product.options[o.name],callback:function(e){t.$set(t.form.product.options,o.name,e)},expression:"form.product.options[field.name]"}},t._l(o.options,function(o){return e("el-option",{key:o.id,attrs:{value:o,label:t.optionLabel(o)}})})):t._e(),t._v(" "),"radio"===o.type?e("div",[e("el-radio-group",{attrs:{size:"small"},model:{value:t.form.product.options[o.name],callback:function(e){t.$set(t.form.product.options,o.name,e)},expression:"form.product.options[field.name]"}},t._l(o.options,function(o){return e("el-radio-button",{key:o.id,attrs:{label:o}},[t._v(t._s(t.optionLabel(o)))])}))],1):t._e()],1)],1)],1)}))]}),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{md:12}},[e("h5",[t._v("Quantity")])])],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{md:{span:16,offset:4}}},[e("el-form-item",{attrs:{label:"Quantity",size:"small",prop:"product.quantity"}},[e("el-select",{model:{value:t.form.product.quantity,callback:function(o){t.$set(t.form.product,"quantity",o)},expression:"form.product.quantity"}},t._l(t.quantityRange,function(t){return e("el-option",{key:t,attrs:{value:t}})}))],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{md:12}},[e("h5",[t._v("Price")])])],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{md:{span:16,offset:4}}},t._l(t.formattedPrice(t.form.product),function(o,r){return e("p",[e("strong",[t._v(t._s(r)+":")]),t._v(" "+t._s(t.shopData.currency)+t._s(o))])}))],1)],2)]),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(o){t.closeAndClearModal(null)}}},[t._v(t._s(t.editForm?"Discard Changes":"Cancel"))]),t._v(" "),t.editForm?t._e():e("el-button",{attrs:{type:"primary"},on:{click:function(o){t.addProduct()}}},[t._v("Add Product")]),t._v(" "),t.editForm?e("el-button",{attrs:{type:"primary"},on:{click:function(o){t.saveProduct()}}},[t._v("Save Changes")]):t._e()],1)],1)])],1)},staticRenderFns:[]}},mBvu:function(t,o,e){var r=e("VU/8")(e("TFx0"),e("jPnQ"),!1,function(t){e("ZKm+")},null,null);t.exports=r.exports}});